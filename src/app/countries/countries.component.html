<!-- Todo: Cleanup css -->
<!-- Loading indicator (This should have it's own Component/service)-->
<div
  *ngIf="isLoading; else content"
  class="fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center"
>
  <div class="lds-ring mb-4">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>
  <div class="text-xl text-white">...Please wait while loading</div>
</div>
<!-- //Loading indicator -->

<!-- Notification (This should have it's own Component/service) -->
<div
  *ngIf="notificationMessage"
  class="fixed top-4 right-4 bg-white shadow-md p-4 max-w-sm min-w-[250px] border-b-4 border-green-500"
>
  <div class="flex items-center justify-between">
    <div class="flex items-center">
      <i class="material-icons text-green-500 mr-2">done</i>
      <!-- Message -->
      <p class="text-gray-700">{{ notificationMessage }}</p>
    </div>
    <button
      class="text-gray-500 hover:text-red-500 pt-2"
      (click)="notificationMessage = null"
    >
      <i class="material-icons">close</i>
    </button>
  </div>
</div>
<!--//Notification -->

<ng-template #content>
  <!-- search and filter -->
  <div class="flex items-center bg-gray-200 p-4 mb-4">
    <input
      type="text"
      class="flex-grow h-10 px-5 pr-10 rounded-full text-sm focus:outline-none"
      placeholder="Search by name or FIFA..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="filterCountriesByNameOrFIFA()"
    />
    <select
      class="ml-3 h-10 rounded-full text-l"
      [(ngModel)]="selectedRegion"
      [ngModelOptions]="{ standalone: true }"
      (ngModelChange)="filterCountriesByRegion()"
    >
      <option [ngValue]="'all'">All Regions</option>
      <option *ngFor="let regionItem of region" [ngValue]="regionItem">
        {{ regionItem }}
      </option>
    </select>
  </div>
  <!-- //search and filter -->
  <!-- Favorite bar -->
  <div class="mb-6">
    <a routerLink="favorites" class="text-white font-semibold mb-2"
      >Favorites</a
    >
    <span
      *ngFor="let country of favoriteCountries"
      class="inline-flex items-center rounded-md px-2 mr-2 py-1 text-blue-400 ring-1 ring-inset ring-blue-500/30 mb-2"
    >
      {{ country }}
    </span>
  </div>
  <!-- //Favorite bar -->
  <!-- Country grid -->
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-10 mb-6"
  >
    <div
      *ngFor="let country of filteredCountries"
      class="bg-white pl-2 pr-2 sm:pl-0 sm:pr-0 flex flex-col justify-between h-full"
    >
      <!-- Item header -->
      <div class="flex items-center bg-gray-200" *ngIf="isFavorite(country.id)">
        <i class="material-icons text-red-400 pl-2">favorite</i>
        <p
          class="text-xl pb-2 pt-2 pl-2 overflow-hidden overflow-ellipsis whitespace-nowrap max-w-[200px]"
        >
          {{ country.name }}
        </p>
      </div>
      <div
        class="flex items-center bg-gray-200"
        *ngIf="!isFavorite(country.id)"
      >
        <p
          class="text-xl pb-2 pt-2 pl-2 overflow-hidden overflow-ellipsis whitespace-nowrap max-w-[200px]"
        >
          {{ country.name }}
        </p>
      </div>
      <!-- //Item header -->
      <!-- Item body -->
      <div class="bg-gray-900">
        <div class="lg:hover:scale-105 transition duration-300 relative">
          <!-- Country flag -->
          <img
            class="w-full object-cover h-40 grayscale transition-transform duration-300 ease-in-out transform hover:grayscale-0"
            [src]="country.flagUrl"
            alt="Flag of {{ country.name }}"
          />
          <!-- // Country flag -->
          <!-- Coat Of Arms -->
          <img
            class="absolute right-2 bottom-2 h-1/4"
            [src]="country.coatOfArmsUrl"
          />
          <!-- //Coat Of Arms -->
        </div>

        <!-- Buttons -->
        <div class="flex">
          <button
            class="flex-grow bg-blue-500 hover:bg-blue-400 text-white font-bold py-2 px-4 rounded-none flex items-center justify-center"
          >
            <i class="material-icons pr-2">group</i
            >{{ country.population | numberFormat }}
          </button>
          <!-- Favorite button -->
          <button
            class="flex-grow text-white font-bold py-2 px-4 rounded-none flex items-center justify-center bg-green-400 hover:bg-green-700"
            (click)="saveFavorite(country)"
          >
            <i
              class="material-icons text-{{
                isFavorite(country.id) ? 'red' : 'white'
              }}-400"
            >
              favorite
            </i>
          </button>
          <!-- //Favorite button -->
        </div>
        <!-- //Buttons -->
      </div>
      <!-- Item body -->
    </div>
  </div>
  <!-- //country grid -->
</ng-template>
<!-- //#Content -->
